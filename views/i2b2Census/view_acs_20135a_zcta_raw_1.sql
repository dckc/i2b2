--this view will create the percentage portions for acs data.
create view i2b2data.vw_acs_zcta5_patient_zip_raw_dimension_1 as
select pd.*,
UEC001,
UED001,
UEE001,
UEF001,
UEF002,
UEF003,
UEG001,
UEG002,
UEG003,
UEH001,
UEH002,
UEH003,
UEI001,
UEI002,
UEI003,
UEJ001,
UEJ002,
UEJ003,
UEK001,
UEK002,
UEK003,
UEL001,
UEL002,
UEL003,
UEM001,
UEM002,
UEM003,
UEN001,
UEN002,
UEN003,
UEO001,
UEO002,
UEO003,
UEP001,
UEQ001,
UES001,
UET001,
UEU001,
UEV001,
UEW001,
UEX001,
UER001,
UEY001,
UEZ001,
UE0001,
UE1001,
UE2001,
UE3001,
UE6001,
UE7001,
UE8001,
UE9001,
UFA001,
UFB001,
UFC001,
UE4001,
UE5001,
UFD001,
UFD002,
UFD003,
UFD004,
UFD005,
UFD006,
UFD007,
UFD008,
UFD009,
UFD010,
UFE001,
UFE002,
UFE003,
UFE004,
UFE005,
UFE006,
UFE007,
UFE008,
UFE010,
UFE009,
UFE011,
UFE012,
UFF001,
UFG001,
UFH001,
UFI001,
UFJ001,
UFK001,
UFL001
  from i2b2data.i2b2data.patient_dimension pd, i2b2Census.i2b2Census.acs_20135a_zcta_id acs, 
  i2b2Census.i2b2Census.acs_20135a_zcta_860_ge_00_1 zcta1
  where substring(pd.zip_cd, 1, 5) = acs.zcta5
  and acs.id = zcta1.id




--populate the column selects for raw
--select variable_code + ','
--  from i2b2Census.i2b2Census.acs_20135a_definition
--	where total_column_name is null
--	and table_universe is not null
--	and table_location = 1