--this view will create the percentage portions for acs data.
create view i2b2data.vw_acs_zcta5_patient_zip_raw_dimension_6 as
select pd.*,
UMO004,
UMO005,
UMP001,
UMP002,
UMP003,
UMP004,
UMP005,
UMP006,
UMP007,
UMP008,
UMQ001,
UMR001,
UMR002,
UMR003,
UMS001,
UMT001,
UME001,
UMF001,
UMG001,
UMH001,
UMI001,
UMJ001,
UMK001,
UML001,
UMM001,
UMN001,
UMO001,
UMO002,
UMO003,
UM6001,
UM7001,
UM8001,
UM9001,
UNA001,
UNB001,
UNC001,
UND001,
UNE001,
UNF001,
UNG001,
UNH001,
UNI001,
UNJ001,
UNK001,
UNL001,
UNM001,
UNN001,
UNO001,
UNP001,
UNQ001,
UNR001,
UNS001,
UNT001,
UNU001,
UNV001,
UNW001,
UNX001,
UNY001,
UNZ001,
UN0001,
UN1001,
UN2001,
UN3001,
UN4001,
UN5001,
UN6001,
UN7001,
UN8001,
UN9001,
UOA001,
UMU001,
UMV001,
UMW001,
UMW002,
UMW003,
UMX001,
UMX002,
UMX003,
UMY001,
UMZ001,
UMZ002,
UMZ003,
UM0001,
UM1001,
UM2001,
UM3001,
UM4001,
UM5001,
UOO001,
UOP001,
UOQ001,
UOR001,
UOS001,
UOT001,
UOU001,
UOB001,
UOC001,
UOD001,
UOE001,
UOF001,
UOG001,
UOH001,
UOI001,
UOJ001,
UOK001,
UOL001,
UOM001,
UON001
  from i2b2data.i2b2data.patient_dimension pd, i2b2Census.i2b2Census.acs_20135a_zcta_id acs, 
  i2b2Census.i2b2Census.acs_20135a_zcta_860_ge_00_6 zcta6
  where substring(pd.zip_cd, 1, 5) = acs.zcta5
  and acs.id = zcta6.id6





--populate the column selects for raw
--select variable_code + ','
--  from i2b2Census.i2b2Census.acs_20135a_definition
--	where total_column_name is null
--	and table_universe is not null
--	and table_location = 6