--this view will create the percentage portions for acs data.
create view i2b2data.vw_acs_zcta5_patient_zip_raw_dimension_3 as
select pd.*,
UGS001,
UG3001,
UG4001,
UHB001,
UHC001,
UHD001,
UHE001,
UHF001,
UHG001,
UHH001,
UHI001,
UHJ001,
UHK001,
UHL001,
UHM001,
UHN001,
UHO001,
UHP001,
UHQ001,
UHR001,
UHS001,
UHT001,
UHU001,
UHV001,
UHW001,
UHX001,
UHY001,
UHY002,
UHY003,
UHY004,
UHY005,
UHZ001,
UHZ002,
UHZ003,
UHZ004,
UHZ005,
UH0001,
UH1001,
UH2001,
UGT001,
UGU001,
UGV001,
UGW001,
UGX001,
UGY001,
UGZ001,
UG0001,
UG1001,
UG2001,
UG5001,
UG6001,
UG7001,
UG8001,
UG9001,
UG9002,
UG9003,
UG9004,
UG9005,
UHA001,
UH3001,
UH4001,
UH5001,
UH6001,
UH7001,
UH8001,
UH9001,
UIA001,
UIB001,
UIC001,
UID001,
UIE001,
UIF001,
UIG001,
UIH001,
UII001,
UII002,
UII003,
UII004,
UII005,
UIJ001,
UIJ002,
UIJ003,
UIJ004,
UIJ005,
UIJ006,
UIK001,
UIK002,
UIK003,
UIK004,
UIK005,
UIK006,
UIL001,
UIM001,
UIN001,
UIO001,
UIP001,
UIQ001,
UIR001,
UIT001,
UIS001,
UIU001,
UIV001,
UIW001,
UIX001,
UIY001,
UIZ001,
UI0001,
UI1001,
UJQ001,
UJR001,
UJS001,
UI2001,
UI3001,
UI4001,
UI5001,
UI6001,
UI7001,
UI8001,
UI9001,
UJA001,
UJB001,
UJC001,
UJD001,
UJE001,
UJF001,
UJG001,
UJH001,
UJI001,
UJJ001,
UJK001,
UJL001,
UJM001,
UJO001,
UJN001,
UJP001,
UJT001,
UJU001
  from i2b2data.i2b2data.patient_dimension pd, i2b2Census.i2b2Census.acs_20135a_zcta_id acs, 
  i2b2Census.i2b2Census.acs_20135a_zcta_860_ge_00_3 zcta3
  where substring(pd.zip_cd, 1, 5) = acs.zcta5
  and acs.id = zcta3.id3





--populate the column selects for raw
--select variable_code + ','
--  from i2b2Census.i2b2Census.acs_20135a_definition
--	where total_column_name is null
--	and table_universe is not null
--	and table_location = 4