--this view will create the percentage portions for acs data.
create view i2b2data.vw_acs_zcta5_patient_zip_raw_dimension_5 as
select pd.*,
ULB001,
ULB002,
ULB003,
ULC001,
ULC002,
ULC003,
ULD001,
ULD002,
ULD003,
ULD004,
ULD005,
ULD006,
ULD007,
ULD008,
ULE001,
ULF001,
ULG001,
ULH001,
ULI001,
ULJ001,
ULK001,
ULK002,
ULK003,
ULL001,
ULM001,
ULM002,
ULM003,
ULN001,
ULO001,
ULP001,
ULQ001,
ULR001,
ULS001,
ULT001,
ULT002,
ULT003,
ULU001,
ULV001,
ULW001,
ULX001,
ULY001,
ULZ001,
UL0001,
UL1001,
UKK001,
UKL001,
UKM001,
UKN001,
UKO001,
UKP001,
UKQ001,
UKR001,
UKS001,
UKT001,
UKU001,
UKV001,
UKW001,
UKX001,
UKY001,
UKZ001,
UK0001,
UK1001,
UK2001,
UK3001,
UK3002,
UK3003,
UK4001,
UK5001,
UK6001,
UK7001,
UK8001,
UK9001,
ULA001,
UL2001,
UL3001,
UL4001,
UL5001,
UL6001,
UL7001,
UL8001,
UL9001,
UMA001,
UMB001,
UMB002,
UMB003,
UMB004,
UMB005,
UMB006,
UMB007,
UMB008,
UMC001,
UMC002,
UMC003,
UMD001
  from i2b2data.i2b2data.patient_dimension pd, i2b2Census.i2b2Census.acs_20135a_zcta_id acs, 
  i2b2Census.i2b2Census.acs_20135a_zcta_860_ge_00_5 zcta5
  where substring(pd.zip_cd, 1, 5) = acs.zcta5
  and acs.id = zcta5.id5






--populate the column selects for raw
--select variable_code + ','
--  from i2b2Census.i2b2Census.acs_20135a_definition
--	where total_column_name is null
--	and table_universe is not null
--	and table_location = 5